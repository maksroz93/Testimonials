<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í—ñ–¥–≥—É–∫–∏ –ø–∞—Ü—ñ—î–Ω—Ç—ñ–≤ | –õ—ñ–∫–∞—Ä –ú–∞–∫—Å–∏–º</title>
    
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/3063/3063822.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.18.0/js/md5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #2c3e50;
            --bg: #F5F7FA;
            --card-bg: #ffffff;
            --text-secondary: #6B7280;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 0;
            color: var(--primary);
            line-height: 1.5;
        }

        /* --- STYLES --- */
        .profile-header {
            background: white;
            text-align: center;
            padding: 40px 20px;
            border-bottom: 1px solid #eee;
            margin-bottom: 40px;
        }
        .profile-img {
            width: 100px; height: 100px; border-radius: 50%; object-fit: cover;
            margin-bottom: 15px; border: 3px solid white; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .profile-name { font-size: 1.5rem; font-weight: 700; margin: 0 0 5px 0; }
        .profile-bio { color: var(--text-secondary); font-size: 0.95rem; margin-bottom: 20px; }
        .btn-primary {
            display: inline-block; background-color: #007AFF; color: white; text-decoration: none;
            padding: 12px 24px; border-radius: 50px; font-weight: 600; transition: transform 0.2s;
        }
        .btn-primary:hover { transform: translateY(-2px); }

        .wall-container {
            column-count: 3; column-gap: 20px; max-width: 1100px; margin: 0 auto; padding: 0 20px 60px 20px;
        }
        .review-card {
            background: var(--card-bg); border-radius: 16px; padding: 24px; margin-bottom: 20px;
            break-inside: avoid; box-shadow: 0 2px 8px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.03);
            transition: transform 0.2s;
        }
        .review-card:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.08); }

        .stars { color: #FFB400; font-size: 1.2rem; margin-bottom: 12px; letter-spacing: 2px; }
        .review-text { font-size: 0.95rem; color: #374151; margin-bottom: 20px; }

        .author { border-top: 1px solid #f3f4f6; padding-top: 15px; display: flex; align-items: center; gap: 12px; }
        .patient-avatar { width: 44px; height: 44px; border-radius: 50%; background-color: #eee; object-fit: cover; border: 1px solid #eee; }
        
        .author-info { display: flex; flex-direction: column; overflow: hidden; }
        
        .author-name {
            font-weight: 600; font-size: 0.95rem; color: var(--primary); text-decoration: none;
            display: inline-flex; align-items: center; white-space: nowrap;
        }
        a.author-name:hover { text-decoration: underline; color: #007AFF; }
        
        .social-icon { width: 16px; height: 16px; margin-left: 6px; vertical-align: middle; }
        .author-detail { font-size: 0.8rem; color: #9CA3AF; margin-top: 2px; }

        @media (max-width: 900px) { .wall-container { column-count: 2; } }
        @media (max-width: 600px) { .wall-container { column-count: 1; } }
    </style>
</head>
<body>

    <div class="profile-header">
        <img src="https://cdn-icons-png.flaticon.com/512/3774/3774299.png" alt="Doctor" class="profile-img">
        <h1 class="profile-name">–í–∞—à–µ –Ü–º'—è</h1>
        <p class="profile-bio">–î–∏—Ç—è—á–∏–π –Ω–µ–≤—Ä–æ–ª–æ–≥</p>
        <a href="LINKTREE_URL" class="btn-primary">üìÖ –ó–∞–ø–∏—Å–∞—Ç–∏—Å—å</a>
    </div>

    <div id="reviews-wall" class="wall-container">
        <p style="text-align:center; color:#999">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
    </div>

    <script>
        // –í–ê–®–ï –ü–û–°–ò–õ–ê–ù–ù–Ø –ù–ê CSV
        const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSs5tdxHhDMHgMHYlC8sms6RUVGDBvG_6lSp2F8SQ-0GqmtgjIPNbG9ekag5Pk5goHEeZCHAy9UA6YN/pub?gid=167862335&single=true&output=csv';

        // –ë–∞–∑–∞ —ñ–∫–æ–Ω–æ–∫ (–ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ CDN)
        const icons = {
            instagram: 'https://cdn-icons-png.flaticon.com/512/174/174855.png',
            facebook: 'https://cdn-icons-png.flaticon.com/512/5968/5968764.png',
            tiktok: 'https://cdn-icons-png.flaticon.com/512/3046/3046121.png',
            telegram: 'https://cdn-icons-png.flaticon.com/512/2111/2111646.png',
            youtube: 'https://cdn-icons-png.flaticon.com/512/1384/1384060.png',
            twitter: 'https://cdn-icons-png.flaticon.com/512/5969/5969020.png', // X logo
            linkedin: 'https://cdn-icons-png.flaticon.com/512/174/174857.png',
            default: 'https://cdn-icons-png.flaticon.com/512/1006/1006771.png' // –ü–ª–∞–Ω–µ—Ç–∞
        };

        function getStars(rating) {
            if (!rating) rating = 5;
            return '‚òÖ'.repeat(rating) + '‚òÜ'.repeat(5 - rating);
        }

        // –§—É–Ω–∫—Ü—ñ—è-–¥–µ—Ç–µ–∫—Ç–æ—Ä —Å–æ—Ü–º–µ—Ä–µ–∂—ñ
        function detectSocial(link) {
            if (!link) return null;
            link = link.toLowerCase();
            
            // –Ø–∫—â–æ –ª—é–¥–∏–Ω–∞ –≤–≤–µ–ª–∞ –ø—Ä–æ—Å—Ç–æ @–Ω—ñ–∫, –≤–≤–∞–∂–∞—î–º–æ —Ü–µ –Ü–Ω—Å—Ç–∞–≥—Ä–∞–º–æ–º
            if (link.startsWith('@')) return { type: 'instagram', url: `https://instagram.com/${link.substring(1)}`, icon: icons.instagram };
            
            // –ù–æ—Ä–º–∞–ª—ñ–∑—É—î–º–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è (–¥–æ–¥–∞—î–º–æ https —è–∫—â–æ –Ω–µ–º–∞—î)
            let fullUrl = link.startsWith('http') ? link : `https://${link}`;

            if (fullUrl.includes('instagram.com')) return { type: 'instagram', url: fullUrl, icon: icons.instagram };
            if (fullUrl.includes('facebook.com') || fullUrl.includes('fb.com')) return { type: 'facebook', url: fullUrl, icon: icons.facebook };
            if (fullUrl.includes('tiktok.com')) return { type: 'tiktok', url: fullUrl, icon: icons.tiktok };
            if (fullUrl.includes('t.me') || fullUrl.includes('telegram.org')) return { type: 'telegram', url: fullUrl, icon: icons.telegram };
            if (fullUrl.includes('youtube.com') || fullUrl.includes('youtu.be')) return { type: 'youtube', url: fullUrl, icon: icons.youtube };
            if (fullUrl.includes('linkedin.com')) return { type: 'linkedin', url: fullUrl, icon: icons.linkedin };
            if (fullUrl.includes('twitter.com') || fullUrl.includes('x.com')) return { type: 'twitter', url: fullUrl, icon: icons.twitter };

            // –Ø–∫—â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –ø—ñ–¥—ñ–π—à–ª–æ - –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ "–°–∞–π—Ç"
            return { type: 'website', url: fullUrl, icon: icons.default };
        }

        window.handleImageError = function(img, fallbackUrl) {
            if (img.src !== fallbackUrl) img.src = fallbackUrl;
        };

        Papa.parse(sheetUrl, {
            download: true,
            header: true,
            skipEmptyLines: true,
            complete: function(results) {
                const data = results.data;
                const container = document.getElementById('reviews-wall');
                container.innerHTML = '';

                data.forEach(row => {
                    const review = row['Review'] || row['–í—ñ–¥–≥—É–∫'] || row['Feedback'];
                    if (!review) return;

                    const name = row['Name'] || row["–Ü–º'—è"] || '–ê–Ω–æ–Ω—ñ–º–Ω–æ';
                    const rating = parseInt(row['Rating'] || row['–û—Ü—ñ–Ω–∫–∞'] || '5');
                    const detail = row['Detail'] || row['–î–µ—Ç–∞–ª—ñ'] || ''; 
                    const email = row['Email'] || row['email'] || row['–ü–æ—à—Ç–∞'] || '';
                    
                    // --- –û–ë–†–û–ë–ö–ê –ü–û–°–ò–õ–ê–ù–ù–Ø ---
                    // –ß–∏—Ç–∞—î–º–æ –∫–æ–ª–æ–Ω–∫—É Link –∞–±–æ –ü–æ—Å–∏–ª–∞–Ω–Ω—è
                    const rawLink = row['Link'] || row['–ü–æ—Å–∏–ª–∞–Ω–Ω—è'] || row['Social'] || row['Instagram'] || '';
                    const socialData = detectSocial(rawLink);

                    // --- –ê–í–ê–¢–ê–†–ö–ê ---
                    // 1. –°–ø–æ—á–∞—Ç–∫—É –ø—Ä–æ–±—É—î–º–æ Gravatar (–ü–æ—à—Ç–∞)
                    let avatarUrl = '';
                    if (email) {
                        const emailHash = md5(email.trim().toLowerCase());
                        avatarUrl = `https://www.gravatar.com/avatar/${emailHash}?d=404&s=200`;
                    }
                    
                    // 2. –Ø–∫—â–æ —î –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Å–æ—Ü–º–µ—Ä–µ–∂—É, –ø—Ä–æ–±—É—î–º–æ –≤–∏—Ç—è–≥–Ω—É—Ç–∏ —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ unavatar (—Ü–µ –ø—Ä–∞—Ü—é—î –¥–ª—è –±–∞–≥–∞—Ç—å–æ—Ö —Å–∞–π—Ç—ñ–≤)
                    let unavatarUrl = '';
                    if (socialData) {
                        // unavatar –≤–º—ñ—î –±—Ä–∞—Ç–∏ —ñ–∫–æ–Ω–∫—É —Å–∞–π—Ç—É –∞–±–æ —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ—ñ–ª—é, —è–∫—â–æ –ø–æ—â–∞—Å—Ç–∏—Ç—å
                        unavatarUrl = `https://unavatar.io/${socialData.url.replace('https://', '')}`;
                    }
                    
                    // –Ø–∫—â–æ Gravatar –Ω–µ–º–∞—î, —Å—Ç–∞—Ä—Ç—É—î–º–æ –∑ unavatar, —è–∫—â–æ —ñ —Ç–æ–≥–æ –Ω–µ–º–∞—î - —ñ–Ω—ñ—Ü—ñ–∞–ª–∏
                    let initialSrc = avatarUrl || unavatarUrl || `https://ui-avatars.com/api/?name=${name}&background=random&color=fff`;
                    const fallbackSrc = `https://ui-avatars.com/api/?name=${name}&background=random&color=fff&size=128`;

                    // --- HTML –Ü–ú–ï–ù–Ü ---
                    let nameHtml = '';
                    if (socialData) {
                        // –Ø–∫—â–æ —î –ø–æ—Å–∏–ª–∞–Ω–Ω—è - –¥–æ–¥–∞—î–º–æ —ñ–∫–æ–Ω–∫—É
                        nameHtml = `
                            <a href="${socialData.url}" target="_blank" class="author-name">
                                ${name} 
                                <img src="${socialData.icon}" class="social-icon" alt="${socialData.type}"/>
                            </a>`;
                    } else {
                        nameHtml = `<span class="author-name">${name}</span>`;
                    }

                    const card = document.createElement('div');
                    card.className = 'review-card';
                    
                    card.innerHTML = `
                        <div class="stars">${getStars(rating)}</div>
                        <div class="review-text">${review}</div>
                        <div class="author">
                            <img src="${initialSrc}" 
                                 class="patient-avatar" 
                                 onerror="handleImageError(this, '${fallbackSrc}')">
                            <div class="author-info">
                                ${nameHtml}
                                ${detail ? `<span class="author-detail">${detail}</span>` : ''}
                            </div>
                        </div>
                    `;

                    container.appendChild(card);
                });
            }
        });
    </script>
</body>
</html>
